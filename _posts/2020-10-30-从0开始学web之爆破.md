\---
 layout:   post        # ä½¿ç”¨çš„å¸ƒå±€ï¼ˆä¸éœ€è¦æ”¹ï¼‰
 title:   ä»0å¼€å§‹å­¦webä¹‹çˆ†ç ´  # æ ‡é¢˜ 
 subtitle:   ctfshow    #å‰¯æ ‡é¢˜
 date:    2020-10-30     # æ—¶é—´
 author:   yanmie       # ä½œè€…
 header-img: img/.jpg  ##æ ‡ç­¾è¿™ç¯‡æ–‡ç« æ ‡é¢˜èƒŒæ™¯å›¾ç‰‡
 catalog: true            # æ˜¯å¦å½’æ¡£
 tags:                
   \- CTF

 \---

## web21 ~å¯†ç çˆ†ç ´

```
çˆ†ç ´ä»€ä¹ˆçš„ï¼Œéƒ½æ˜¯åŸºæ“
```

ä¸‹è½½é™„ä»¶ï¼Œæ‹–è¿› `winhex`ï¼Œæ–‡ä»¶å¤´å¼€å¤´ `504B0304`, æ˜¯å‹ç¼©åŒ…æ–‡ä»¶å¤´ã€‚

æˆ–è€… kali `binwalk` .

æ”¹åç¼€ã€‚è§£å‹æ˜¯ç»™çš„å­—å…¸è®©çˆ†ç ´ã€‚

è¿˜ä»¥ä¸ºæ˜¯å‹ç¼©åŒ…çˆ†ç ´ã€‚ã€‚ã€‚

[![BN228O.png](https://s1.ax1x.com/2020/10/30/BN228O.png)](https://imgchr.com/i/BN228O)

[![BN2R2D.png](https://s1.ax1x.com/2020/10/30/BN2R2D.png)](https://imgchr.com/i/BN2R2D)

è§£ç ä¹‹åæ˜¯æŠ“åˆ°çš„è¾“å…¥çš„ ç”¨æˆ·å:å¯†ç ã€‚

é‚£ä¹ˆå’‹ä¸”å°†ç”¨æˆ·åçŒœæµ‹ä¸º admin ï¼Œçˆ†ç ´å¯†ã€‚

å†™ä¸ªè„šæœ¬ï¼Œæ”¹æˆè¿™ç§æ ¼å¼çš„å­—å…¸ã€‚

```python
import base64
fp = open('pinjie.txt','w')
with open("1000-top.txt", "r") as f:
	for line in f.readlines():
		line = line.strip('\n')
		line = 'admin:'+line
		print (line)
		line1=base64.b64encode(line.encode('utf-8'))
		#print(str(line1,'utf-8')) 		fp.write(str(line1,'utf-8')+'\n')
```

ç„¶åå¯¼å…¥å­—å…¸çˆ†ç ´ã€‚

ä½†æ˜¯çœ‹åˆ«äººåšå®¢ï¼Œæœ‰å¤´å·å­¦åˆ°äº†ä¸€ç§æ–¹æ³•ï¼Œç›´æ¥burpçˆ†ç ´ã€‚

é‡‡ç”¨ Custom iteratorè¿›è¡Œçˆ†ç ´

[![BNf0Kg.png](https://s1.ax1x.com/2020/10/31/BNf0Kg.png)](https://imgchr.com/i/BNf0Kg)

[![BNf2GV.png](https://s1.ax1x.com/2020/10/31/BNf2GV.png)](https://imgchr.com/i/BNf2GV)

[![BNfR2T.md.png](https://s1.ax1x.com/2020/10/31/BNfR2T.md.png)](https://imgchr.com/i/BNfR2T)

[![BNfqG6.md.png](https://s1.ax1x.com/2020/10/31/BNfqG6.md.png)](https://imgchr.com/i/BNfqG6)

[![BNh9II.md.png](https://s1.ax1x.com/2020/10/31/BNh9II.md.png)](https://imgchr.com/i/BNh9II)

[![BNODqx.md.png](https://s1.ax1x.com/2020/10/31/BNODqx.md.png)](https://imgchr.com/i/BNODqx)

## web22~å­åŸŸåæŒ–æ˜

```
åŸŸåä¹Ÿå¯ä»¥çˆ†ç ´çš„ï¼Œè¯•è¯•çˆ†ç ´è¿™ä¸ªctfer.com çš„å­åŸŸå
```

å­åŸŸåæŒ–æ˜. `flag.ctf.show/index.php`

å¯ç”¨å·¥å…· 

https://github.com/ring04h/wydomain

https://github.com/lijiejie/subDomainsBrute

Layerå­åŸŸåæŒ–æ˜æœº

## web23~è„šæœ¬çˆ†ç ´

```
è¿˜çˆ†ç ´ï¼Ÿè¿™ä¹ˆå¤šä»£ç ï¼Œå‘Šè¾ï¼
```

é¢˜ç›®æºç ï¼š

```php
<?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-03 11:43:51
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-03 11:56:11
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/
error_reporting(0);

include('flag.php');
if(isset($_GET['token'])){
    $token = md5($_GET['token']);
    if(substr($token, 1,1)===substr($token, 14,1) && substr($token, 14,1) ===substr($token, 17,1)){
        if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1))){
            echo $flag;
        }
    }
}else{
    highlight_file(__FILE__);

}
?>

```

éœ€è¦ä¼ é€’ä¸€ä¸ª `token` å€¼ï¼Œå†™è„šæœ¬çˆ†ç ´(å‡è®¾æœ‰ä¸¤ä½å­—ç¬¦ã€‚)

```php
 <?php

error_reporting(0);
$string = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
$len = strlen($string);
# echo $len;
for($i=0;$i<$len;$i++)
	for($j=0;$j<$len;$j++)
	{
		$flag = $string[$i].$string[$j];
		# echo $flag."\n";
		$token = md5($flag);
		# echo $token."\n";
		if(substr($token, 1,1)===substr($token, 14,1) && substr($token, 14,1) ===substr($token, 17,1))
        if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1))){
            echo $flag."\n";
        }
    }

?>
```

æˆåŠŸå¾—åˆ°ï¼š

```
G:\ctf\ctfshow>php 1.php
 ZE
3j
```

## web24~ä¼ªéšæœºæ•°

```
çˆ†ä¸ªğŸ”¨
```

æ‰“å¼€ç¯å¢ƒï¼š

```php
 <?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-03 13:26:39
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-03 13:53:31
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/

error_reporting(0);
include("flag.php");
if(isset($_GET['r'])){
    $r = $_GET['r'];
    mt_srand(372619038);
    if(intval($r)===intval(mt_rand())){
        echo $flag;
    }
}else{
    highlight_file(__FILE__);
    echo system('cat /proc/version');
}

?> Linux version 4.15.0-117-generic (buildd@lcy01-amd64-008) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #118-Ubuntu SMP Fri Sep 4 20:02:41 UTC 2020 Linux version 4.15.0-117-generic (buildd@lcy01-amd64-008) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #118-Ubuntu SMP Fri Sep 4 20:02:41 UTC 2020 
```

å‡½æ•°ä»‹ç»ï¼š

```
mt_scrand() //æ’­ç§ Mersenne Twister éšæœºæ•°ç”Ÿæˆå™¨ã€‚
mt_rand()   //ç”Ÿæˆéšæœºæ•°
```

ä¼ªéšæœºæ•°ã€‚

```php
<?php
mt_srand(372619038);
echo mt_rand();
```

è®¾ç½®ä¸­ä¹‹åï¼Œå‡ºæ¥çš„éšæœºæ•°æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æˆ‘çš„å’‹å’Œæ­£ç¡®çš„ä¸ä¸€æ ·ã€‚ã€‚ã€‚ã€‚

å¯èƒ½æ˜¯ç‰ˆæœ¬é—®é¢˜ï¼Ÿ

> mt_scrand(seed)è¿™ä¸ªå‡½æ•°çš„æ„æ€ï¼Œæ˜¯é€šè¿‡åˆ†å‘seedç§å­ï¼Œç„¶åç§å­æœ‰äº†åï¼Œé mt_rand()ç”Ÿæˆéšæœº æ•°ã€‚ æç¤ºï¼šä» PHP 4.2.0 å¼€å§‹ï¼Œéšæœºæ•°ç”Ÿæˆå™¨è‡ªåŠ¨æ’­ç§ï¼Œå› æ­¤æ²¡æœ‰å¿…è¦ä½¿ç”¨è¯¥å‡½æ•° å› æ­¤ä¸éœ€è¦æ’­ç§ï¼Œå¹¶ä¸”å¦‚æœè®¾ç½®äº† seedå‚æ•° ç”Ÿæˆçš„éšæœºæ•°å°±æ˜¯ä¼ªéšæœºæ•°ï¼Œæ„æ€å°±æ˜¯æ¯æ¬¡ç”Ÿæˆçš„éšæœºæ•° æ˜¯ä¸€æ ·çš„

## web25~mt_scrandçˆ†ç§å­

```
çˆ†ä¸ªğŸ”¨ï¼Œä¸çˆ†äº†
```

é¢˜ç›®æºç ï¼š

```php
 <?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-09-03 13:56:57
# @Last Modified by:   h1xa
# @Last Modified time: 2020-09-03 15:47:33
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/


error_reporting(0);
include("flag.php");
if(isset($_GET['r'])){
    $r = $_GET['r'];
    mt_srand(hexdec(substr(md5($flag), 0,8)));
    $rand = intval($r)-intval(mt_rand());
    if((!$rand)){
        if($_COOKIE['token']==(mt_rand()+mt_rand())){
            echo $flag;
        }
    }else{
        echo $rand;
    }
}else{
    highlight_file(__FILE__);
    echo system('cat /proc/version');
}
Linux version 4.15.0-117-generic (buildd@lcy01-amd64-008) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #118-Ubuntu SMP Fri Sep 4 20:02:41 UTC 2020 Linux version 4.15.0-117-generic (buildd@lcy01-amd64-008) (gcc version 7.5.0 (Ubuntu 7.5.0-3ubuntu1~18.04)) #118-Ubuntu SMP Fri Sep 4 20:02:41 UTC 2020 
```

* mt_scrand(seed)è¿™ä¸ªå‡½æ•°çš„æ„æ€ï¼Œæ˜¯é€šè¿‡åˆ†å‘seedç§å­ï¼Œç„¶åç§å­æœ‰äº†åï¼Œé mt_rand()ç”Ÿæˆéšæœºæ•°ã€‚

ç§å­å›ºå®šï¼Œä¹‹åç”Ÿæˆçš„ä¼ªéšæœºæ•°ä¹Ÿå°±å›ºå®šäº†ã€‚

```
æˆ‘çŸ¥é“ç§å­åï¼Œå¯ä»¥ç¡®å®šä½ è¾“å‡ºä¼ªéšæœºæ•°çš„åºåˆ—ã€‚
çŸ¥é“ä½ çš„éšæœºæ•°åºåˆ—ï¼Œå¯ä»¥ç¡®å®šä½ çš„ç§å­ã€‚  
```

å·¥å…·ï¼Œ[php_mt_seed](https://github.com/lepiaf/php_mt_seed)

å…ˆæ¨ç®—å‡ºï¼Œä»–å›ºå®šç§å­åäº§ç”Ÿçš„éšæœºæ•°ã€‚

ä¼ å‚ `r=0`å¾—åˆ° `-1967863495`,é‚£ä¹ˆéšæœºæ•°å°±æ˜¯ `1967863495`

ä¸‹è½½å·¥å…·ï¼Œè§£å‹ï¼Œè¿›å…¥ç›®å½•

```bash
make
./php_mt_seed 1967863495
```

æˆåŠŸå¾—åˆ°ä¸¤ä¸ªç§å­ã€‚

```bash
root@kali:~/php_mt_seed-master# ./php_mt_seed 1967863495
Found 0, trying 1577058304 - 1610612735, speed 23967451 seeds per second 
seed = 1601502238
Found 1, trying 2080374784 - 2113929215, speed 24429013 seeds per second 
seed = 2083727514
Found 2, trying 4261412864 - 4294967295, speed 24951184 seeds per second 
Found 2
```

çˆ†å‡ºä¸¤ä¸ªéšæœºæ•°ç§å­ã€‚

```php
<?php
mt_srand(1601502238);
echo mt_rand()+mt_rand();
```

ä¸¤ä¸ªéƒ½çˆ†ä¸€ä¸‹ï¼Œä½†æ˜¯è¿™é‡Œé¢˜ç›®å¥½åƒæœ‰é—®é¢˜ã€‚ã€‚ã€‚ã€‚çˆ†å‡ºæ¥çš„å’Œwpä¸ä¸€æ ·ã€‚

##  web26~æºä»£ç 

```
è¿™ä¸ªå¯ä»¥çˆ†
```

è¿›å…¥å®‰è£…é¡µé¢ï¼Œ

å‘ç° js ä»£ç 

```javascript
<script>

		function check(){
			$.ajax({
			url:'checkdb.php',
			type: 'POST',
			dataType:'json',
			data:{
				'a':$('#a').val(),
				'p':$('#p').val(),
				'd':$('#d').val(),
				'u':$('#u').val(),
				'pass':$('#pass').val()
			},
			success:function(data){
				alert(data['msg']);
			},
			error:function(data){
				alert(data['msg']);
			}

		});
		}


	</script>
```

post ä¼ å‚`a=&p=&d=&u=&pass=`

å¾—åˆ°

```
{"success":true,"msg":"\u6570\u636e\u5e93\u8fde\u63a5\u6210\u529f","flag":"flag{dee7ac63-de1c-45f3-9804-7e107d168bd8}"} 
```

## web27~çˆ†ç ´å‡ºç”Ÿå¹´æœˆ

```
CTFshowèœé¸¡å­¦é™¢æ‹›ç”Ÿå•¦ï¼
```

æ‰“å¼€é¡µé¢æ˜¯æ­£æ–¹æ•™åŠ¡ç³»ç»Ÿï¼Œä»”ç»†ç‚¹çœ‹ä¸‹é¢æœ‰ä¸ªå½•å–åå•ï¼Œå’Œ å­¦ç”Ÿå­¦ç±ä¿¡æ¯æŸ¥è¯¢ç³»ç»Ÿ

ç‚¹å½•å–åå•ï¼Œä¸‹è½½ï¼Œæ‰“å¼€ã€‚

[![BUKmnI.md.png](https://s1.ax1x.com/2020/10/31/BUKmnI.md.png)](https://imgchr.com/i/BUKmnI)

çœ‹æ¥æ˜¯è¦

[![BUKWE6.md.png](https://s1.ax1x.com/2020/10/31/BUKWE6.md.png)](https://imgchr.com/i/BUKWE6)

è¦çˆ†ç ´èº«ä»½è¯ä¸­é—´å‡ºç”Ÿå¹´æœˆäº†ã€‚

[![BUMtRe.md.png](https://s1.ax1x.com/2020/10/31/BUMtRe.md.png)](https://imgchr.com/i/BUMtRe)

æˆåŠŸçˆ†ç ´ï¼Œ

å¾—åˆ°

```
{"0":"success","msg":"æ­å–œæ‚¨ï¼Œæ‚¨å·²è¢«æˆ‘æ ¡å½•å–ï¼Œä½ çš„å­¦å·ä¸º02015237 åˆå§‹å¯†ç ä¸ºèº«ä»½è¯å·ç "}
```

ç™»å½•å¾—åˆ°flag.

wpè„šæœ¬

```php
<?php
//621022********5237
$myfile = fopen("zid.txt", "w") or die("Unable to open file!");
for($year=1990;$year<1993;$year++){
for($mon=1;$mon<10;$mon++){
for($day=01;$day<10;$day++)
{
$txt=('621022'.$year.'0'.$mon.'0'.$day.'5237')."\n";
fwrite($myfile, $txt);
}
}
} 
for($year=1990;$year<1993;$year++){
for($mon=1;$mon<10;$mon++){
for($day=10;$day<=31;$day++)
{
$txt=('621022'.$year."0".$mon.$day.'5237')."\n";
fwrite($myfile, $txt);
}
}
} 
for($year=1990;$year<1993;$year++){
for($mon=10;$mon<=12;$mon++){
for($day=10;$day<=31;$day++)
{
$txt=('621022'.$year.$mon.$day.'5237')."\n";
fwrite($myfile, $txt);
}
}
} 
for($year=1990;$year<1993;$year++){
for($mon=10;$mon<=12;$mon++){
for($day=01;$day<10;$day++)
{
$txt=('621022'.$year.$mon."0".$day.'5237')."\n";
fwrite($myfile, $txt);
}
}
} 
fclose($myfile);
```

## web28

```
å¤§æµ·æé’ˆ
```

